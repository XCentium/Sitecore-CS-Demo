@model CSDemo.Contracts.GeneralSearch.ISearch
@if (Model == null)
{
	return;
}
@*<section class="breadcrumb-wrapper">
	<div class="container">
		<div class="row">
			<div class="col-xs-12">
				@Model.TotalItemCount @(Model.TotalItemCount == 1 ? "result" : "results") for <p>"@Model.Query"</p>
			</div>
		</div>
	</div>
</section>*@
<section class="content products">
	<div class="container">
		<div class="row">			

            @*<div class="col-sm-3">
                <aside class="sidebar">                    
                </aside>
            </div>*@
            <div class="col-xs-@(Model.Results.Any() ? "9":"12")">               


                @if (!Model.Results.Any())
                {
                    <p>No products matched your search criteria. Please change your search query and try again.</p>
                }
                else
                {
                    <div class="products-header">
                        <div class="row">                            
                            <div>
                                <div class="btn-group toggle-list-grid hidden-xs" role="group">
                                    <button type="button" class="btn btn-default active" id="toggle-grid"><i class="fa fa-th"></i></button>
                                    <button type="button" class="btn btn-default" id="toggle-list"><i class="fa fa-list"></i></button>
                                </div>                               
                            </div>
                        </div>
                    </div>

                    <form id="promo-form" name="promo-form">
                        <div class="row grid" id="products">
                            @foreach (var result in Model.Results)
                            {
                                @Html.Partial("_SearchResultFree", result)
                            }
                        </div>
                    </form>
                    if (Model.TotalPageCount > 1)
                    {
                        var left = (Model.CurrentPageNumber > 1) ? Model.CurrentPageNumber - 1 : 1;
                        var right = (Model.CurrentPageNumber < Model.TotalPageCount) ? Model.CurrentPageNumber + 1 : Model.TotalPageCount;

                        var leftUrl = string.Format("q={0}&pn={1}", Model.Query, left);
                        if (Model.PageSize > 0)
                        {
                            leftUrl += string.Format("&ps={0}", Model.PageSize);
                        }

                        var rightUrl = string.Format("q={0}&pn={1}", Model.Query, right);
                        if (Model.PageSize > 0)
                        {
                            rightUrl += string.Format("&ps={0}", Model.PageSize);
                        }

                        <div class="pagination-wrapper">
                            <ul id="products_search_page" class="pagination">
                                <li><a val="@left" href="~/search?@leftUrl"><i class="fa fa-angle-double-left"></i></a></li>
                                @for (int i = 0; i < Model.TotalPageCount; i++)
                                {
                                    var thePage = i + 1;
                                    var active = (Model.CurrentPageNumber == thePage) ? " class=active" : "";

                                    var currentpageUrl = string.Format("q={0}&pn={1}", Model.Query, thePage);
                                    if (Model.PageSize > 0)
                                    {
                                        currentpageUrl += string.Format("&ps={0}", Model.PageSize);
                                    }

                                    <li @active><a val="@thePage" href="~/search?@currentpageUrl">@thePage</a></li>
                                }
                                <li><a val="@right" href="~/search?@rightUrl"><i class="fa fa-angle-double-right"></i></a></li>
                            </ul>
                        </div>
                        }
                        }
</div>
		</div>

        <div class="row">
            <div class="clearfix">                
                <a href="/checkout/payment" data-contextitemid="@Sitecore.Context.Item.ID.ToString()" class="btn btn-primary btn-lg pull-left">Skip</a>
                <a href="/checkout/payment" data-contextitemid="@Sitecore.Context.Item.ID.ToString()" class="btn btn-primary btn-lg pull-right SubmitPromo">Continue To Payment</a>
            </div>
        </div>
	</div>
</section>
